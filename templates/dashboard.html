<!DOCTYPE html>
<html>
<head>
    <title>Dashboard - HabitPro</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="layout">

    <!-- Sidebar -->
    <div class="sidebar">
        <h2>HabitPro</h2>
        <a href="/dashboard">Dashboard</a>
        <a href="/profile">Profile</a>
        <a href="/logout">Logout</a>
        <button onclick="toggleDarkMode()">Toggle Theme</button>
    </div>

    <!-- Main Content -->
    <div class="main">

        <h1>Dashboard</h1>

        <!-- Add Habit -->
        <form method="POST" action="/add_habit" class="add-form">
            <input type="text" name="habit" placeholder="Habit Name" required>

            <select name="category" required>
                <option value="Health">Health</option>
                <option value="Study">Study</option>
                <option value="Fitness">Fitness</option>
                <option value="Coding">Coding</option>
                <option value="Personal">Personal</option>
            </select>

            <button type="submit">Add Habit</button>
        </form>

        <!-- Statistics -->
        <div class="stats">
            <div class="card">
                <h3>Total Habits</h3>
                <p>{{ total }}</p>
            </div>

            <div class="card">
                <h3>Completed Today</h3>
                <p>{{ today }}</p>
            </div>

            <div class="card">
                <h3>Success Rate</h3>
                <p>{{ percent }}%</p>
            </div>
        </div>

        <!-- Weekly Chart -->
        <div class="chart-box">
            <canvas id="weeklyChart"></canvas>
        </div>

        <!-- Habit List -->
        <div class="habit-list">
            {% for habit in habits %}
            <div class="habit-item">
                <div class="habit-info">
                    <h3>{{ habit.name }}</h3>
                    <span class="badge">{{ habit.category }}</span>
                    <p>ðŸ”¥ Streak: {{ habit.streak }}</p>
                </div>

                <div class="actions">
                    <a href="/complete/{{ habit.id }}" class="done">Done</a>
                    <a href="/edit/{{ habit.id }}" class="edit">Edit</a>
                    <a href="/delete/{{ habit.id }}" class="delete"
                       onclick="return confirm('Are you sure you want to delete this habit?')">
                       Delete
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>

    </div>
</div>

<!-- Chart Script -->
<script>
const weeklyData = {{ weekly | tojson }};

new Chart(document.getElementById('weeklyChart'), {
    type: 'bar',
    data: {
        labels: ['6d','5d','4d','3d','2d','1d','Today'],
        datasets: [{
            label: 'Weekly Completions',
            data: weeklyData,
            borderRadius: 6
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                labels: {
                    color: "#ffffff"
                }
            }
        },
        scales: {
            x: {
                ticks: { color: "#ffffff" }
            },
            y: {
                ticks: { color: "#ffffff" }
            }
        }
    }
});
</script>

<script src="/static/script.js"></script>

</body>
</html>
